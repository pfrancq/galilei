# programme pour faire les graphqiues sous R
#source ("rprograph")

creategraph<-function(filename, nbtests)
{
x<-as.matrix(read.table(filename))
nbsubtests<-nrow(x)/nbtests;
mmeanprecision<-matrix(ncol=1, nrow=nbtests)
mmeanrecall<-matrix(ncol=1, nrow=nbtests)
mmeanglobal<-matrix(ncol=1, nrow=nbtests)
main = "red = Recall ; black = Precision ; green = Global"
for (i in 1:nbtests)
{

mprecision<-matrix(1,ncol=1)
mrecall<-matrix(1,ncol=1)
mglobal<-matrix(1,ncol=1)
for (j in (nbsubtests*(i-1)+1):(nbsubtests*i))
{
mprecision<-rbind(mprecision,as.matrix(x[j,1]))
mrecall<-rbind(mrecall,as.matrix(x[j,2]))
mglobal<-rbind(mglobal,as.matrix(x[j,3]))
}
mprecision<-as.matrix(mprecision[-1,])
mrecall<-as.matrix(mrecall[-1,])
mglobal<-as.matrix(mglobal[-1,])
str<-paste("GraphTest",i,sep="")
jpeg(str)
plot(mprecision, col=1, ylim=c(0,1), xlim=c(1,nbsubtests))
lines(mprecision)
title(main)
par(new=T)
plot(mrecall, col=2, ylim=c(0,1), xlim=c(1,nbsubtests))
lines(mrecall)
title(main)
par(new=T)
plot(mglobal, col=3, ylim=c(0,1), xlim=c(1,nbsubtests))
lines(mglobal)
title(main)
xlab=" feedback"
mmeanprecision[i,1]<-mean(mprecision[])
mmeanrecall[i,1]<-mean(mrecall[])
mmeanglobal[i,1]<-mean(mglobal[])
}
jpeg("GraphMean")

plot(mmeanprecision, col=1, ylim=c(0,1), xlim=c(1,nbtests))
lines(mmeanprecision)
par(new=T)
plot(mmeanrecall, col=2, ylim=c(0,1), xlim=c(1,nbtests))
lines(mmeanrecall)
par(new=T)
plot(mmeanglobal, col=3, ylim=c(0,1), xlim=c(1,nbtests))
lines(mmeanglobal)
main = "red = Recall ; black = Precision ; green = Global"
title(main)
}
